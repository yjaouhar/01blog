<!-- Backdrop -->
<!-- <div class="modal-backdrop fade show"></div> -->

<!-- Bottom Sheet -->
<div class="position-fixed  start-0 end-0 d-flex justify-content-center"
    style="z-index:1055">

    <div class="bg-white w-100 rounded-top shadow"
        style="max-width: 500px; max-height: 92vh; overflow: hidden">

        <!-- Handle -->
        <div class="d-flex justify-content-center py-2">
            <div style="width:40px;height:5px"
                class="bg-secondary rounded-pill"></div>
        </div>

        <!-- Header -->
        <div
            class="d-flex align-items-center justify-content-between px-3 py-2 border-bottom">
            <button class="btn btn-link text-secondary p-0" (click)="close()">Cancel</button>

            <h6 class="m-0 fw-bold">Create Post</h6>

            <button class="btn btn-success btn-sm rounded-pill px-3"
                [disabled]="!content().trim()" (click)="submit()">
                Post
            </button>
        </div>

        <!-- Content -->
        <div class="p-3 overflow-auto" style="max-height:60vh">

            <div class="d-flex gap-3">
                <!-- Textarea -->
                <textarea class="form-control border-0 fs-5 shadow-none" style="resize: none;"
                    rows="4"
                    [value]="content()"
                    placeholder="What's on your mind?"
                    (input)="changeContent($event)"></textarea>
            </div>

            <!-- Media preview -->

            <div class="mt-3 d-flex flex-wrap gap-2">
                @for (media of mediaFiles(); track $index) {

                <div class="position-relative rounded overflow-hidden"
                    style="max-width:140px;">

                    @switch (media.type) {
                    @case ("image") {
                    <img [src]="media.url"
                        class="img-fluid">
                    }@case ("video") {
                    <video [src]="media.url"
                        class="img-fluid" controls></video>
                    }
                    }

                    <button
                        class="btn btn-dark btn-sm position-absolute top-0 end-0 m-1"
                        (click)="removeMedia($index)">âœ•</button>
                </div>
                }
            </div>
        </div>

        <!-- Toolbar -->
        <div
            class="border-top px-3 py-2 d-flex justify-content-between align-items-center">
            <div class="d-flex gap-1">
                <label class="btn btn-light btn-sm rounded-circle mb-0"
                    title="Add Image">
                    <i class="bi bi-image text-success"></i>
                    <input type="file" accept="image/*" hidden
                        (change)="addMedia($event)">
                </label>
                <label class="btn btn-light btn-sm rounded-circle mb-0"
                    title="Add Video">
                    <i class="bi bi-camera-video text-success"></i>
                    <input type="file" accept="video/*" hidden
                        (change)="addMedia($event)">
                </label>
            </div>

        </div>
        @if (hasError()) {
        <div class="text-danger small text-center">
            <pre style="white-space: pre-wrap;">{{messagError()}}</pre>
        </div>
        }
    </div>
</div>

<div class="container-fluid py-4 admin-panel">

    <!-- ====== CARDS ====== -->
    <div class="row g-3 mb-4">

        <div class="col-md-3">
            <div class="card shadow-sm stat-card users-card">
                <div class="card-body text-white">
                    <h6>Total Users</h6>
                    <h2>{{ stats.totalUsers }}</h2>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card shadow-sm stat-card posts-card">
                <div class="card-body text-white">
                    <h6>Total Posts</h6>
                    <h2>{{ stats.totalPosts }}</h2>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card shadow-sm stat-card reports-card">
                <div class="card-body text-white">
                    <h6>Active Reports</h6>
                    <h2>{{ stats.activeReports }}</h2>
                </div>
            </div>
        </div>

        <div class="col-md-3">
            <div class="card shadow-sm stat-card banned-card">
                <div class="card-body text-white">
                    <h6>Banned Items</h6>
                    <h2>{{ stats.banned }}</h2>
                </div>
            </div>
        </div>

    </div>

    <!-- ====== TABS ====== -->
    <ul class="nav nav-tabs mb-3" id="adminTabs">
        <li class="nav-item">
            <button class="nav-link" [class.active]="tab === 'users'"
                (click)="tab='users'">Users</button>
        </li>
        <li class="nav-item">
            <button class="nav-link" [class.active]="tab === 'posts'"
                (click)="tab='posts'">Posts</button>
        </li>
        <li class="nav-item">
            <button class="nav-link" [class.active]="tab === 'reports'"
                (click)="tab='reports'">Reports</button>
        </li>
        <li class="nav-item">
            <button class="nav-link" [class.active]="tab === 'banned'"
                (click)="tab='banned'">Banned</button>
        </li>
    </ul>

    <!-- ========== USERS ========== -->
    @if (tab === 'users') {
    <div class="card shadow-sm">
        <div class="card-header bg-white">
            <strong>Users</strong>
        </div>

        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                    <tr>
                        <th>Avatar</th>
                        <th>Username</th>
                        <th>Email</th>
                        <th class="text-end">Actions</th>
                    </tr>
                </thead>

                <tbody>
                    @for (u of users; track u.id) {
                    <tr>
                        <td><img [src]="u.avatar" class="avatar-img"></td>
                        <td>{{ u.username }}</td>
                        <td>{{ u.email }}</td>
                        <td class="text-end">

                            <i
                                class="bi bi-person-vcard-fill text-primary me-3 fs-3"
                                [routerLink]="['/profile',u.username]"
                                data-bs-toggle="tooltip"
                                title="open profile"></i>

                            <i
                                class="bi bi-person-fill-slash text-warning me-3 fs-3"
                                data-bs-toggle="tooltip"
                                title="Disable user"
                                data-bs-toggle="modal"
                                [attr.data-bs-target]="'#confermModalBanUser'+selectUserId()"
                                (click)="changeSelectedUser(u.id)"></i>
                            <i class="bi bi-person-fill-x text-danger fs-3 me-3"
                                data-bs-toggle="tooltip"
                                title="Delete user"
                                data-bs-toggle="modal"
                                [attr.data-bs-target]="'#confermModalDeletUser'+selectUserId()"
                                (click)="changeSelectedUser(u.id)"></i>

                        </td>

                    </tr>
                    }
                </tbody>
            </table>

            <div class="modal fade"
                [id]="'confermModalBanUser'+selectUserId()"
                tabindex="-1"
                aria-modal="true" role="dialog">
                <app-confirm-component [id]="'BanUser'+selectUserId()"
                    (conferm)="banUser($event , selectUserId())"
                    message="do you want to bane user"></app-confirm-component>
            </div>
            <div class="modal fade"
                [id]="'confermModalDeletUser'+selectUserId()"
                tabindex="-1"
                aria-modal="true" role="dialog">
                <app-confirm-component [id]="'DeletUser'+selectUserId()"
                    (conferm)="deleteUser($event , selectUserId())"
                    message="do you want to delet user"></app-confirm-component>
            </div>
        </div>
    </div>
    }

    <!-- ========== POSTS ========== -->
    @if (tab === 'posts') {
    <div class="card shadow-sm">
        <div class="card-header bg-white">
            <strong>Posts</strong>
        </div>

        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                    <tr>
                        <th>ID</th>
                        <th>Author</th>
                        <th>Excerpt</th>
                        <th class="text-end">Actions</th>
                    </tr>
                </thead>

                <tbody>
                    <!-- @for (p  of []; track p.id) {
                    <tr>
                        <td>{{ p.id }}</td>
                        <td>{{ p.authore }}</td>
                        <td>{{ p.descreption }}</td>
                        <td class="text-end">
                            <i class="bi bi-folder2-open text-primary fs-4 me-3"
                                data-bs-toggle="tooltip"
                                title="Show post"
                                (click)="viewpost(p)"
                                data-bs-toggle="modal"
                                [attr.data-bs-target]="'#postModal'+selectPostId()"></i>

                            <i
                                class="bi bi-eye-slash-fill text-warning me-3 fs-4"
                                data-bs-toggle="tooltip"
                                title="Hide post"
                                data-bs-toggle="modal"
                                [attr.data-bs-target]="'#confermModalBanPoste'+selectPostId()"
                                (click)="changeSelectedPost(p.id)"></i>
                            <i class="bi bi-trash-fill text-danger fs-4 me-3"
                                data-bs-toggle="tooltip"
                                title="'Delete poste"
                                data-bs-toggle="modal"
                                [attr.data-bs-target]="'#confermModalDeletPoste'+selectPostId()"
                                (click)="changeSelectedPost(p.id)"></i>

                        </td>
                    </tr>
                    } -->
                </tbody>
            </table>
            <div class="modal fade"
                [id]="'confermModalBanPoste'+selectPostId()"
                tabindex="-1"
                aria-modal="true" role="dialog">
                <app-confirm-component [id]="'BanPoste'+selectPostId()"
                    (conferm)="banPoste($event , selectPostId())"
                    message="do you want to bane post"></app-confirm-component>
            </div>
            <div class="modal fade"
                [id]="'confermModalDeletPoste'+selectPostId()"
                tabindex="-1"
                aria-modal="true" role="dialog">
                <app-confirm-component [id]="'DeletPoste'+selectPostId()"
                    (conferm)="deletePost($event , selectPostId())"
                    message="do you want to delet post"></app-confirm-component>
            </div>
            <div class="modal fade" [id]="'postModal'+selectPostId()"
                tabindex="-1"
                aria-hidden="true">
                <!-- <app-comment-component
                    [post]="selectPost"></app-comment-component> -->
            </div>
        </div>

    </div>
    }

    <!-- ========== REPORTS ========== -->
    @if (tab === 'reports') {
    <div class="card shadow-sm">
        <div class="card-header bg-white">
            <strong>Reports</strong>
        </div>
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                    <tr>
                        <th style="width: 5%;">Type</th>
                        <th>REPORTS</th>
                    </tr>
                </thead>
                <tbody>
                    @for (r of reports; track r.id) {
                    <tr>
                        <td class="    align-content-center text-center">
                            @if (r.type==='post') {
                            <i class="bi bi-file-post text-primary fs-3"></i>
                            }@else{
                            <i class="bi bi-person-fill  text-primary fs-3"></i>
                            }
                        </td>
                        <td>
                            <div class="d-flex justify-content-between p-2">
                                <div class="d-flex gap-3">
                                    <strong>{{r.reason}}</strong>
                                    <small>{{r.time}}</small>
                                </div>

                                <div class="d-flex gap-3">
                                    <i class="bi bi-trash-fill text-danger fs-4"
                                        data-bs-toggle="tooltip"
                                        [title]="'Delete '+r.type"></i>
                                    @if (r.type==='post') {
                                    <i
                                        class="bi bi-eye-slash-fill text-warning fs-4"
                                        data-bs-toggle="tooltip"
                                        title="Hide post"></i>
                                    }

                                    <i
                                        class=" bi bi-dash-circle-fill text-danger-emphasis fs-4"
                                        data-bs-toggle="tooltip"
                                        [title]="'Disable '+ r.targetUser"></i>
                                    <i class="bi bi-x-lg fs-4"></i>
                                </div>
                            </div>

                        </td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
    }

    <!-- ========== BANNED ========== -->
    @if (tab === 'banned') {
    <div class="card shadow-sm">

        <div class="card-header bg-white">
            <strong>Banned List</strong>
        </div>

        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead class="table-light">
                    <tr>
                        <th>Type</th>
                        <th>Target</th>
                        <th>Date</th>
                        <th class="text-end">Actions</th>
                    </tr>
                </thead>

                <tbody>
                    @for (b of banned; track b.date) {
                    <tr>
                        <td>
                            @if (b.type==='Post') {
                            <i class="bi bi-file-post text-primary fs-3"></i>
                            }@else{
                            <i class="bi bi-person-fill  text-primary fs-3"></i>
                            }
                        </td>
                        <td>{{ b.name }}</td>
                        <td>{{ b.date }}</td>
                        <td class="text-end ">
                            @if (b.type==='Post') {
                            <i
                                class="bi bi-eye-fill fs-3 text-success me-3"></i>
                            }@else {
                            <i
                                class="bi bi-person-fill-check fs-3 text-success me-3"></i>
                            }
                        </td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>

    </div>
    }

</div>

<div class="container mt-5">
  <div class="card shadow-sm p-4">
    <h2 class="mb-4 text-center">Register</h2>
    <form [formGroup]="registerForm" (ngSubmit)="submit()" class="form">

      <div class="row">
        <!-- First Name -->
        <div class="col-md-6 mb-3">
          <label>First Name</label>
          <span class="ms-2 text-danger">*</span>
          <input type="text" class="form-control" formControlName="firstName">
          @if (registerForm.get('firstName')?.touched &&
          registerForm.get('firstName')?.invalid ) {
          <div class="text-danger small">
            First Name must be between 2 and 20 characters
          </div>
          }
        </div>

        <!-- Last Name -->
        <div class="col-md-6 mb-3">
          <label>Last Name</label>
          <span class="ms-2 text-danger">*</span>
          <input type="text" class="form-control" formControlName="lastName">
          @if (registerForm.get('lastName')?.touched &&
          registerForm.get('lastName')?.invalid) {
          <div
            class="text-danger small">
            Last Name must be between 2 and 20 characters
          </div>
          }
        </div>
      </div>

      <!-- Gender -->
      <div class="mb-3">
        <label>Gender</label>
        <span class="ms-2 text-danger">*</span>
        <select class="form-select" formControlName="gender">
          <option value>Choose...</option>
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
        @if (registerForm.get('gender')?.touched &&
        registerForm.get('gender')?.invalid) {
        <div
          class="text-danger small">
          Gender must be 'male' or 'female'.
        </div>
        }
      </div>

      <!-- Age -->
      <div class="mb-3">
        <label>Birthday</label>
        <span class="ms-2 text-danger">*</span>
        <input type="date" class="form-control" formControlName="birthday"
          (change)="changeBirthaday($event)">
        @if ((registerForm.get('age')?.touched &&
        registerForm.get('age')?.invalid) || birthdayError()) {
        <div
          class="text-danger small">
          must have 10 years old.
        </div>
        }
      </div>

      <!-- Bio -->
      <div class="mb-3">
        <label>Bio</label>
        <textarea class="form-control" rows="3"
          formControlName="bio"></textarea>
        @if (registerForm.get('bio')?.touched &&
        registerForm.get('bio')?.invalid) {
        <div
          class="text-danger small">
          Max 200 characters.
        </div>
        }
      </div>

      <!-- Username -->
      <div class="mb-3">
        <label>Username</label>
        <input type="text" class="form-control" formControlName="username">
        @if (registerForm.get('username')?.touched &&
        registerForm.get('username')?.invalid) {
        <div
          class="text-danger small">
          Username must be between 4 and 15 characters.
        </div>
        }
      </div>

      <!-- Email -->
      <div class="mb-3">
        <label>Email</label>
        <span class="ms-2 text-danger">*</span>
        <input type="email" class="form-control" formControlName="email">
        @if (registerForm.get('email')?.touched &&
        registerForm.get('email')?.invalid) {
        <div
          class="text-danger small">
          Enter a valid email.
        </div>
        }
      </div>

      <!-- Password -->
      <div class="mb-3">
        <label>Password</label>
        <span class="ms-2 text-danger">*</span>
        <input type="password" class="form-control" formControlName="password">
        @if (registerForm.get('password')?.touched &&
        registerForm.get('password')?.invalid) {
        <div
          class="text-danger small">
          Password should be at least 8 characters.
        </div>
        }
      </div>

      <!-- Avatar -->
      <div class="mb-3">
        <label>Avatar</label>
        <input type="file" class="form-control" formControlName="avatar"
          (change)="onFileSelect($event)">
      </div>
      <!-- ==== Modal resoze avatar ==== -->
      <div class="modal fade" id="avatarModal" tabindex="-1">
        <div class="modal-dialog">
          <div class="modal-content p-3">
            <h5 class="mb-2">Crop & Resize Avatar</h5>

            <!-- viewport square -->
            <div class="crop-wrapper">
              <div class="crop-viewport" #viewport>
                <img #cropImage src draggable="false" class="crop-img" />
                <!-- optional overlay for circle preview -->
                <div class="crop-overlay"></div>
              </div>
            </div>

            <div class="mt-3">
              <label class="form-label">Zoom</label>
              <input type="range" min="0.5" max="3" step="0.01" [value]="scale"
                (input)="onZoom($event)">
            </div>

            <div class="d-flex gap-2 mt-3">
              <button class="btn btn-secondary"
                (click)="closeModal()">Cancel</button>
              <button class="btn btn-primary"
                (click)="confirmAvatar()">Confirm</button>
            </div>
          </div>
        </div>
      </div>

      <button class="btn btn-primary w-100 mb-2" type="submit">Register</button>
    </form>
  </div>
</div>
